import{b as y}from"./index-8YLEdGs1.js";const U=t=>{let e;const r=new Set,o=(i,S)=>{const v=typeof i=="function"?i(e):i;if(!Object.is(v,e)){const h=e;e=S??(typeof v!="object"||v===null)?v:Object.assign({},e,v),r.forEach(m=>m(e,h))}},a=()=>e,c={setState:o,getState:a,getInitialState:()=>d,subscribe:i=>(r.add(i),()=>r.delete(i))},d=e=t(o,a,c);return c},j=t=>t?U(t):U,R=t=>t;function k(t,e=R){const r=y.useSyncExternalStore(t.subscribe,y.useCallback(()=>e(t.getState()),[t,e]),y.useCallback(()=>e(t.getInitialState()),[t,e]));return y.useDebugValue(r),r}const H=t=>{const e=j(t),r=o=>k(e,o);return Object.assign(r,e),r},w=t=>t?H(t):H;function E(t,e){let r;try{r=t()}catch{return}return{getItem:a=>{var s;const f=d=>d===null?null:JSON.parse(d,void 0),c=(s=r.getItem(a))!=null?s:null;return c instanceof Promise?c.then(f):f(c)},setItem:(a,s)=>r.setItem(a,JSON.stringify(s,void 0)),removeItem:a=>r.removeItem(a)}}const p=t=>e=>{try{const r=t(e);return r instanceof Promise?r:{then(o){return p(o)(r)},catch(o){return this}}}catch(r){return{then(o){return this},catch(o){return p(o)(r)}}}},x=(t,e)=>(r,o,a)=>{let s={storage:E(()=>localStorage),partialize:n=>n,version:0,merge:(n,g)=>({...g,...n}),...e},f=!1;const c=new Set,d=new Set;let i=s.storage;if(!i)return t((...n)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),r(...n)},o,a);const S=()=>{const n=s.partialize({...o()});return i.setItem(s.name,{state:n,version:s.version})},v=a.setState;a.setState=(n,g)=>(v(n,g),S());const h=t((...n)=>(r(...n),S()),o,a);a.getInitialState=()=>h;let m;const _=()=>{var n,g;if(!i)return;f=!1,c.forEach(u=>{var l;return u((l=o())!=null?l:h)});const b=((g=s.onRehydrateStorage)==null?void 0:g.call(s,(n=o())!=null?n:h))||void 0;return p(i.getItem.bind(i))(s.name).then(u=>{if(u)if(typeof u.version=="number"&&u.version!==s.version){if(s.migrate){const l=s.migrate(u.state,u.version);return l instanceof Promise?l.then(I=>[!0,I]):[!0,l]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,u.state];return[!1,void 0]}).then(u=>{var l;const[I,O]=u;if(m=s.merge(O,(l=o())!=null?l:h),r(m,!0),I)return S()}).then(()=>{b==null||b(m,void 0),m=o(),f=!0,d.forEach(u=>u(m))}).catch(u=>{b==null||b(void 0,u)})};return a.persist={setOptions:n=>{s={...s,...n},n.storage&&(i=n.storage)},clearStorage:()=>{i==null||i.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>_(),hasHydrated:()=>f,onHydrate:n=>(c.add(n),()=>{c.delete(n)}),onFinishHydration:n=>(d.add(n),()=>{d.delete(n)})},s.skipHydration||_(),m||h},C=x,J=w(C(t=>({currentUser:null,setcurrentUser:e=>t({currentUser:e}),updatecurrentUser:()=>t(e=>({currentUser:e})),removecurrentUser:()=>t(()=>({currentUser:null}))})));export{w as c,J as u};
